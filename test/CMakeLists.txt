cmake_minimum_required(VERSION 3.17)
project(ffmpeg_test)
set(FEATURES "avformat;bzip2;postproc;zlib" CACHE STRING "List of all features enabled through vcpkg.")
enable_testing()
add_subdirectory(avutil)
if ("avformat" IN_LIST FEATURES)
  add_subdirectory(avformat)
  if ("bzip2" IN_LIST FEATURES)
    add_test(NAME test_bzip2 COMMAND test_readframe "${CMAKE_CURRENT_SOURCE_DIR}/prores_bz2.mkv")
  endif()
  if ("zlib" IN_LIST FEATURES)
    add_test(NAME test_zlib COMMAND test_readframe "${CMAKE_CURRENT_SOURCE_DIR}/prores_zlib.mkv")
  endif()
endif()
if ("postproc" IN_LIST FEATURES)
  add_subdirectory(postproc)
endif()